## 一、虚拟机环境准备

###1.克隆虚拟机

​	克隆时要先关闭被克隆的虚拟机。要选创建完整克隆。

![1566214483464](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566214483464.png)

###2.修改克隆虚拟机的网卡信息和静态IP

1. 在MAC文件中修改名字为eth0

2. 在网卡信息文件中把hwaddr地址（物理地址）改成MAC文件中的物理地址。

3. 在网卡信息文件中将ipaddr地址改成与被克隆的机子同网段的IP地址。

   ```
   MAC地址查看：vim  /etc/udev/rules.d/70-persistent-net.rules
   网卡信息查看：vim /etc/sysconfig/network-scripts/ifcfg-eth0
   ```

   

![1566212037618](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566212037618.png)





![1566212297220](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566212297220.png)

![1566212777406](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566212777406.png)

###3.修改主机名：		

```
查看：  hostname
修改：  vim /etc/sysconfig/network
```

重启后生效。

###4.配置主机间的主机名和ip的hosts映射

配置了映射信息，可以使用主机名替代ip地址进行通信。				
			

```
	linux: vim /etc/hosts
	windows: vim c:/windows/system32/drivers/etc/hosts
```

![1566215137584](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566215137584.png)

![1566215585904](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566215585904.png)

我们要通过Windows操作系统中xshell、xftp来链接Linux，所以还得再在Windows中进行映射。

方式1.通过命令行的形式更改。

```
vim c:/windows/system32/drivers/etc/hosts
```

方式2.直接找到配置文件在文件中更改。

C:\Windows\System32\drivers\etc目录下的hosts文件中更改

![1566216271945](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566216271945.png)

##如果不能更改配置文件内容

解决办法：

首先复制你需要更改的配置文件到D盘或者桌面

这时可以更改了，更改完后

以管理员身份运行命令提示行

然后输入dos命令

copy "文件路径" "地址"

因为文件名相同，所以会提示你是否覆盖，输入yes直接覆盖即可

![1569642300806](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1569642300806.png)

### 5.关闭防火墙

​		（1）查看防火墙开机启动状态

```
[root@hadoop100桌面]#chkconfig iptables --list 
```

​        （2）设置开机时关闭防火墙			

```
[root@hadoop100桌面]#chkconfig iptables off
```



###6.创建普通用户并为该普通用户赋予root权限

1. 创建普通用户

```
查看是否存在我们要创建的用户名

id qiuhaijun

添加用户

useradd qiuhaijun

设置密码

passwd qiuhaijun

(123456)
```

2. 普通用户赋予root权限（普通用户只有在自己的home目录下才有创建目录的权限）

```
修改配置文件vim /etc/sudoers
在配置文件中root ALL=（ALL）    ALL后面加一行
qiuhaijun  ALL=(ALL)    NOPASSWD: ALL（这个ALL前面有没有空格？？？）
```

![1566217314586](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566217314586.png)

![1566217460069](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566217460069.png)

3.普通用户拥有root权限，在使用时必须加上关键字 sudo才能在其他地方创建目录。

```
切换用户：su  -  qiuhaijun

创建目录：sudo mkdir software
```

![1566218164454](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566218164454.png)

![1566218343829](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566218343829.png)



通过命令来更改创建software目录的用户组和用户

```
sudo  chown qiuhaijun:qiuhaijun software
```

![1566218666838](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566218666838.png)



注意：在使用命令时，先用命令(ll)查看用户对文件或目录是否有操作权限（读、写、执行），如果没有，还得改变文件所属组和用户为当前用户的组和用户名。



### 7.安装JDK

* 先查看是否已经安装过JDK，如果有安装且不能用，则可以先卸载后再安装

  方式1：检测jdk安装包

  ```
  用查看命令 rpm -qa | grep java
  ```

  ```
  显示我
  java-1.7.0-openjdk-1.7.0.111-2.6.7.8.el7.x86_64
  python-javapackages-3.4.1-11.el7.noarch
  tzdata-java-2016g-2.el7.noarch
  javapackages-tools-3.4.1-11.el7.noarch
  java-1.8.0-openjdk-1.8.0.102-4.b14.el7.x86_64
  java-1.8.0-openjdk-headless-1.8.0.102-4.b14.el7.x86_64
  java-1.7.0-openjdk-headless-1.7.0.111-2.6.7.8.el7.x86_64
  ```

  方式2：或用Java命令：Java，javac，Java -version这几个命令看是否有安装过JDK

   卸载方式：rpm -e --nodeps 对应的jdk安装包

  ```
  举一个例：
  [root@localhost software]# rpm -e --nodeps java-1.7.0-openjdk-1.7.0.111-2.6.7.8.el7.x86_64
  
  ```

  之后再次输入rpm -qa | grep java 查看卸载情况，如果干净了则可以安装新的jdk了。

* 开始安装

①上传tar包到服务器

②解压tar包到指定目录/opt/module

```
在jdk安装包所在目录下：tar -zxvf jdk安装包  -C 解压到的目录
```

![1566221299431](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566221299431.png)

③配置环境变量（如果用的通过提权的普通用户，记得关键字sudo）

```
sudo vim  /etc/profile
```

![1566221613943](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566221613943.png)

```
export JAVA_HOME=/opt/module/jdk1.8.0_144
export PATH=$PATH:$JAVA_HOME/bin
```

![1569750311559](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1569750311559.png)

④使新的配置文件生效：

```
source /etc/profile
```

 

注意：

“:”是多个值之间的分隔符；

“$”用来引用环境变量。“:$PATH”表示把系统原有的PATH环境变量的值追加进来以免我们设置的值覆盖系统默认值；

“export”表示发布新配置的环境变量；





## 二、Hadoop环境搭建

①上传tar包到服务器

```
通过xftp将Windows上的tar包上传到Linux中
```

②解压tar包到指定目录/opt/module

![1566229148981](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566229148981.png)

![1566229241326](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566229241326.png)

③配置环境变量 vim  /etc/profile（如果用的普通用户，记得关键字sudo）

先查看hadoop解压后的绝对路径（hadoop解压后就能使用）

pwd

![1566299413452](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566299413452.png)

sudo vim /etc/profile

![1566230751331](C:\Users\qiuhaijun\AppData\Roaming\Typora\typora-user-images\1566230751331.png)

④使新的配置文件生效：source /etc/profile

⑤用hadoop命令验证hadoop环境变量是否配置成功

#### 如果要克隆多个虚拟机，我们可以将被克隆的虚拟机的基本配置配置好，然后再进行克隆

1.先在一台虚拟机上把主机名与ip地址的映射配置好，普通用户权限提升，关闭防火墙，。。。。。。。

2.克隆虚拟机，只用改IP地址，主机名，MAC地址，就行了

```
MAC地址查看：vim  /etc/udev/rules.d/70-persistent-net.rules
网卡信息查看：vim /etc/sysconfig/network-scripts/ifcfg-eth0
修改主机名：  vim /etc/sysconfig/network
```

